/*
 Infinite Scroll PACKAGED v3.0.3
 Automatically add next page

 Licensed GPLv3 for open source use
 or Infinite Scroll Commercial License for commercial use

 https://infinite-scroll.com
 Copyright 2018 Metafizzy
*/
!function(d,c){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(f){return c(d,f)}):"object"==typeof module&&module.exports?module.exports=c(d,require("jquery")):d.jQueryBridget=c(d,d.jQuery)}(window,function(d,c){function f(e,f,m){function g(g,a,b){var l,c="$()."+e+'("'+a+'")';return g.each(function(g,d){var f=m.data(d,e);if(!f)return void h(e+" not initialized. Cannot call methods, i.e. "+c);var k=f[a];if(!k||"_"==a.charAt(0))return void h(c+" is not a valid method");
f=k.apply(f,b);l=void 0===l?f:l}),void 0!==l?l:g}function l(g,a){g.each(function(g,b){var l=m.data(b,e);l?(l.option(a),l._init()):(l=new f(b,a),m.data(b,e,l))})}(m=m||c||d.jQuery)&&(f.prototype.option||(f.prototype.option=function(g){m.isPlainObject(g)&&(this.options=m.extend(!0,this.options,g))}),m.fn[e]=function(e){if("string"==typeof e){var b=a.call(arguments,1);return g(this,e,b)}return l(this,e),this},b(m))}function b(a){!a||a&&a.bridget||(a.bridget=f)}var a=Array.prototype.slice,e=d.console,
h="undefined"==typeof e?function(){}:function(a){e.error(a)};return b(c||d.jQuery),f});
(function(d,c){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",c):"object"==typeof module&&module.exports?module.exports=c():d.EvEmitter=c()})("undefined"!=typeof window?window:this,function(){function d(){}var c=d.prototype;return c.on=function(c,b){if(c&&b){var a=this._events=this._events||{},a=a[c]=a[c]||[];return-1==a.indexOf(b)&&a.push(b),this}},c.once=function(c,b){if(c&&b){this.on(c,b);var a=this._onceEvents=this._onceEvents||{};return(a[c]=a[c]||{})[b]=!0,this}},c.off=
function(c,b){var a=this._events&&this._events[c];if(a&&a.length){var e=a.indexOf(b);return-1!=e&&a.splice(e,1),this}},c.emitEvent=function(c,b){var a=this._events&&this._events[c];if(a&&a.length){a=a.slice(0);b=b||[];for(var e=this._onceEvents&&this._onceEvents[c],d=0;d<a.length;d++){var k=a[d];e&&e[k]&&(this.off(c,k),delete e[k]);k.apply(this,b)}return this}},c.allOff=function(){delete this._events;delete this._onceEvents},d});
(function(d,c){"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",c):"object"==typeof module&&module.exports?module.exports=c():d.matchesSelector=c()})(window,function(){var d=function(){var c=window.Element.prototype;if(c.matches)return"matches";if(c.matchesSelector)return"matchesSelector";for(var d=["webkit","moz","ms","o"],b=0;b<d.length;b++){var a=d[b]+"MatchesSelector";if(c[a])return a}}();return function(c,f){return c[d](f)}});
(function(d,c){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(f){return c(d,f)}):"object"==typeof module&&module.exports?module.exports=c(d,require("desandro-matches-selector")):d.fizzyUIUtils=c(d,d.matchesSelector)})(window,function(d,c){var f={extend:function(a,e){for(var b in e)a[b]=e[b];return a},modulo:function(a,e){return(a%e+e)%e},makeArray:function(a){var e=[];if(Array.isArray(a))e=a;else if(a&&"object"==typeof a&&
"number"==typeof a.length)for(var b=0;b<a.length;b++)e.push(a[b]);else e.push(a);return e},removeFrom:function(a,e){var b=a.indexOf(e);-1!=b&&a.splice(b,1)},getParent:function(a,e){for(;a.parentNode&&a!=document.body;)if(a=a.parentNode,c(a,e))return a},getQueryElement:function(a){return"string"==typeof a?document.querySelector(a):a},handleEvent:function(a){var e="on"+a.type;this[e]&&this[e](a)},filterFindElements:function(a,e){a=f.makeArray(a);var b=[];return a.forEach(function(a){if(a instanceof
HTMLElement){if(!e)return void b.push(a);c(a,e)&&b.push(a);a=a.querySelectorAll(e);for(var d=0;d<a.length;d++)b.push(a[d])}}),b},debounceMethod:function(a,b,c){var e=a.prototype[b],d=b+"Timeout";a.prototype[b]=function(){var a=this[d];a&&clearTimeout(a);var g=arguments,b=this;this[d]=setTimeout(function(){e.apply(b,g);delete b[d]},c||100)}},docReady:function(a){var b=document.readyState;"complete"==b||"interactive"==b?setTimeout(a):document.addEventListener("DOMContentLoaded",a)},toDashed:function(a){return a.replace(/(.)([A-Z])/g,
function(a,b,c){return b+"-"+c}).toLowerCase()}},b=d.console;return f.htmlInit=function(a,e){f.docReady(function(){var c=f.toDashed(e),k="data-"+c,n=document.querySelectorAll("["+k+"]"),c=document.querySelectorAll(".js-"+c),n=f.makeArray(n).concat(f.makeArray(c)),m=k+"-options",g=d.jQuery;n.forEach(function(c){var d,l=c.getAttribute(k)||c.getAttribute(m);try{d=l&&JSON.parse(l)}catch(p){return void(b&&b.error("Error parsing "+k+" on "+c.className+": "+p))}d=new a(c,d);g&&g.data(c,e,d)})})},f});
(function(d,c){"function"==typeof define&&define.amd?define("infinite-scroll/js/core",["ev-emitter/ev-emitter","fizzy-ui-utils/utils"],function(f,b){return c(d,f,b)}):"object"==typeof module&&module.exports?module.exports=c(d,require("ev-emitter"),require("fizzy-ui-utils")):d.InfiniteScroll=c(d,d.EvEmitter,d.fizzyUIUtils)})(window,function(d,c,f){function b(g,c){var d=f.getQueryElement(g);if(!d)return void console.error("Bad element for InfiniteScroll: "+(d||g));if(g=d,g.infiniteScrollGUID)return d=
e[g.infiniteScrollGUID],d.option(c),d;this.element=g;this.options=f.extend({},b.defaults);this.option(c);a&&(this.$element=a(this.element));this.create()}var a=d.jQuery,e={};b.defaults={};b.create={};b.destroy={};var h=b.prototype;f.extend(h,c.prototype);var k=0;h.create=function(){var g=this.guid=++k;if(this.element.infiniteScrollGUID=g,e[g]=this,this.pageIndex=1,this.loadCount=0,this.updateGetPath(),!this.getPath)return void console.error("Disabling InfiniteScroll");this.updateGetAbsolutePath();
this.log("initialized",[this.element.className]);this.callOnInit();for(var a in b.create)b.create[a].call(this)};h.option=function(a){f.extend(this.options,a)};h.callOnInit=function(){var a=this.options.onInit;a&&a.call(this,this)};h.dispatchEvent=function(g,b,c){this.log(g,c);var e=b?[b].concat(c):c;if(this.emitEvent(g,e),a&&this.$element)e=g+=".infiniteScroll",b&&(b=a.Event(b),b.type=g,e=b),this.$element.trigger(e,c)};var n={initialized:function(a){return"on "+a},request:function(a){return"URL: "+
a},load:function(a,b){return(a.title||"")+". URL: "+b},error:function(a,b){return a+". URL: "+b},append:function(a,b,c){return c.length+" items. URL: "+b},last:function(a,b){return"URL: "+b},history:function(a,b){return"URL: "+b},pageIndex:function(a,b){return"current page determined to be: "+a+" from "+b}};h.log=function(a,b){if(this.options.debug){var c="[InfiniteScroll] "+a,g=n[a];g&&(c+=". "+g.apply(this,b));console.log(c)}};h.updateMeasurements=function(){this.windowHeight=d.innerHeight;this.top=
this.element.getBoundingClientRect().top+d.pageYOffset};h.updateScroller=function(){var a=this.options.elementScroll;if(!a)return void(this.scroller=d);if(this.scroller=!0===a?this.element:f.getQueryElement(a),!this.scroller)throw"Unable to find elementScroll: "+a;};h.updateGetPath=function(){var a=this.options.path;if(!a)return void console.error("InfiniteScroll path option required. Set as: "+a);var b=typeof a;return"function"==b?void(this.getPath=a):"string"==b&&a.match("{{#}}")?void this.updateGetPathTemplate(a):
void this.updateGetPathSelector(a)};h.updateGetPathTemplate=function(a){this.getPath=function(){return a.replace("{{#}}",this.pageIndex+1)}.bind(this);var b=a.replace("{{#}}","(\\d\\d?\\d?)");(b=location.href.match(new RegExp(b)))&&(this.pageIndex=parseInt(b[1],10),this.log("pageIndex",this.pageIndex,"template string"))};var m=[/^(.*?\/?page\/?)(\d\d?\d?)(.*?$)/,/^(.*?\/?\?page=)(\d\d?\d?)(.*?$)/,/(.*?)(\d\d?\d?)(?!.*\d)(.*?$)/];return h.updateGetPathSelector=function(a){var b=document.querySelector(a);
if(!b)return void console.error("Bad InfiniteScroll path option. Next link not found: "+a);var c,e;a=b.getAttribute("href");for(b=0;a&&b<m.length;b++)if(e=m[b],e=a.match(e)){c=e.slice(1);break}return c?(this.isPathSelector=!0,this.getPath=function(){return c[0]+(this.pageIndex+1)+c[2]}.bind(this),this.pageIndex=parseInt(c[1],10)-1,void this.log("pageIndex",[this.pageIndex,"next link"])):void console.error("InfiniteScroll unable to parse next link href: "+a)},h.updateGetAbsolutePath=function(){var a=
this.getPath();if(a.match(/^http/)||a.match(/^\//))return void(this.getAbsolutePath=this.getPath);var a=location.pathname,b=a.substring(0,a.lastIndexOf("/"));this.getAbsolutePath=function(){return b+"/"+this.getPath()}},b.create.hideNav=function(){var a=f.getQueryElement(this.options.hideNav);a&&(a.style.display="none",this.nav=a)},b.destroy.hideNav=function(){this.nav&&(this.nav.style.display="")},h.destroy=function(){this.allOff();for(var a in b.destroy)b.destroy[a].call(this);delete this.element.infiniteScrollGUID;
delete e[this.guid]},b.throttle=function(a,b){b=b||200;var c,e;return function(){var d=+new Date,g=arguments,f=function(){c=d;a.apply(this,g)}.bind(this);c&&d<c+b?(clearTimeout(e),e=setTimeout(f,b)):f()}},b.data=function(a){return(a=(a=f.getQueryElement(a))&&a.infiniteScrollGUID)&&e[a]},b.setJQuery=function(b){a=b},f.htmlInit(b,"infinite-scroll"),a&&a.bridget&&a.bridget("infiniteScroll",b),b});
(function(d,c){"function"==typeof define&&define.amd?define("infinite-scroll/js/page-load",["./core"],function(f){return c(d,f)}):"object"==typeof module&&module.exports?module.exports=c(d,require("./core")):c(d,d.InfiniteScroll)})(window,function(d,c){function f(a){for(var b=document.createDocumentFragment(),c=0;a&&c<a.length;c++)b.appendChild(a[c]);return b}function b(a,b,c,d){var e=new XMLHttpRequest;e.open("GET",a,!0);e.responseType=b||"";e.setRequestHeader("X-Requested-With","XMLHttpRequest");
e.onload=function(){200==e.status?c(e.response):d(Error(e.statusText))};e.onerror=function(){d(Error("Network error requesting "+a))};e.send()}var a=c.prototype;return c.defaults.loadOnScroll=!0,c.defaults.checkLastPage=!0,c.defaults.responseType="document",c.create.pageLoad=function(){this.canLoad=!0;this.on("scrollThreshold",this.onScrollThresholdLoad);this.on("load",this.checkLastPage);this.options.outlayer&&this.on("append",this.onAppendOutlayer)},a.onScrollThresholdLoad=function(){this.options.loadOnScroll&&
this.loadNextPage()},a.loadNextPage=function(){if(!this.isLoading&&this.canLoad){var a=this.getAbsolutePath();this.isLoading=!0;var c=function(b){this.onPageLoad(b,a)}.bind(this),d=function(b){this.onPageError(b,a)}.bind(this);b(a,this.options.responseType,c,d);this.dispatchEvent("request",null,[a])}},a.onPageLoad=function(a,b){return this.options.append||(this.isLoading=!1),this.pageIndex++,this.loadCount++,this.dispatchEvent("load",null,[a,b]),this.appendNextPage(a,b),a},a.appendNextPage=function(a,
b){var c=this.options.append;if("document"==this.options.responseType&&c){var d=a.querySelectorAll(c),e=f(d),c=function(){this.appendItems(d,e);this.isLoading=!1;this.dispatchEvent("append",null,[a,b,d])}.bind(this);this.options.outlayer?this.appendOutlayerItems(e,c):c()}},a.appendItems=function(a,b){if(a&&a.length){b=b||f(a);for(var c=b.querySelectorAll("script"),d=0;d<c.length;d++){for(var e=c[d],g=document.createElement("script"),l=g,h=e.attributes,q=0;q<h.length;q++){var p=h[q];l.setAttribute(p.name,
p.value)}e.parentNode.replaceChild(g,e)}this.element.appendChild(b)}},a.appendOutlayerItems=function(a,b){var e=c.imagesLoaded||d.imagesLoaded;return e?void e(a,b):(console.error("[InfiniteScroll] imagesLoaded required for outlayer option"),void(this.isLoading=!1))},a.onAppendOutlayer=function(a,b,c){this.options.outlayer.appended(c)},a.checkLastPage=function(a,b){var c=this.options.checkLastPage;if(c){var d=this.options.path;if("function"==typeof d&&!this.getPath())return void this.lastPageReached(a,
b);var e;if("string"==typeof c?e=c:this.isPathSelector&&(e=d),e&&a.querySelector)a.querySelector(e)||this.lastPageReached(a,b)}},a.lastPageReached=function(a,b){this.canLoad=!1;this.dispatchEvent("last",null,[a,b])},a.onPageError=function(a,b){return this.isLoading=!1,this.canLoad=!1,this.dispatchEvent("error",null,[a,b]),a},c.create.prefill=function(){if(this.options.prefill){var a=this.options.append;if(!a)return void console.error("append option required for prefill. Set as :"+a);this.updateMeasurements();
this.updateScroller();this.isPrefilling=!0;this.on("append",this.prefill);this.once("error",this.stopPrefill);this.once("last",this.stopPrefill);this.prefill()}},a.prefill=function(){(this.isPrefilling=0<=this.getPrefillDistance())?(this.log("prefill"),this.loadNextPage()):this.stopPrefill()},a.getPrefillDistance=function(){return this.options.elementScroll?this.scroller.clientHeight-this.scroller.scrollHeight:this.windowHeight-this.element.clientHeight},a.stopPrefill=function(){console.log("stopping prefill");
this.off("append",this.prefill)},c});
(function(d,c){"function"==typeof define&&define.amd?define("infinite-scroll/js/scroll-watch",["./core","fizzy-ui-utils/utils"],function(f,b){return c(d,f,b)}):"object"==typeof module&&module.exports?module.exports=c(d,require("./core"),require("fizzy-ui-utils")):c(d,d.InfiniteScroll,d.fizzyUIUtils)})(window,function(d,c,f){var b=c.prototype;return c.defaults.scrollThreshold=400,c.create.scrollWatch=function(){this.pageScrollHandler=this.onPageScroll.bind(this);this.resizeHandler=this.onResize.bind(this);
var a=this.options.scrollThreshold;(a||0===a)&&this.enableScrollWatch()},c.destroy.scrollWatch=function(){this.disableScrollWatch()},b.enableScrollWatch=function(){this.isScrollWatching||(this.isScrollWatching=!0,this.updateMeasurements(),this.updateScroller(),this.on("last",this.disableScrollWatch),this.bindScrollWatchEvents(!0))},b.disableScrollWatch=function(){this.isScrollWatching&&(this.bindScrollWatchEvents(!1),delete this.isScrollWatching)},b.bindScrollWatchEvents=function(a){a=a?"addEventListener":
"removeEventListener";this.scroller[a]("scroll",this.pageScrollHandler);d[a]("resize",this.resizeHandler)},b.onPageScroll=c.throttle(function(){this.getBottomDistance()<=this.options.scrollThreshold&&this.dispatchEvent("scrollThreshold")}),b.getBottomDistance=function(){return this.options.elementScroll?this.getElementBottomDistance():this.getWindowBottomDistance()},b.getWindowBottomDistance=function(){return this.top+this.element.clientHeight-(d.pageYOffset+this.windowHeight)},b.getElementBottomDistance=
function(){return this.scroller.scrollHeight-(this.scroller.scrollTop+this.scroller.clientHeight)},b.onResize=function(){this.updateMeasurements()},f.debounceMethod(c,"onResize",150),c});
(function(d,c){"function"==typeof define&&define.amd?define("infinite-scroll/js/history",["./core","fizzy-ui-utils/utils"],function(f,b){return c(d,f,b)}):"object"==typeof module&&module.exports?module.exports=c(d,require("./core"),require("fizzy-ui-utils")):c(d,d.InfiniteScroll,d.fizzyUIUtils)})(window,function(d,c,f){var b=c.prototype;c.defaults.history="replace";var a=document.createElement("a");return c.create.history=function(){if(this.options.history)return a.href=this.getAbsolutePath(),(a.origin||
a.protocol+"//"+a.host)==location.origin?void(this.options.append?this.createHistoryAppend():this.createHistoryPageLoad()):void console.error("[InfiniteScroll] cannot set history with different origin: "+a.origin+" on "+location.origin+" . History behavior disabled.")},b.createHistoryAppend=function(){this.updateMeasurements();this.updateScroller();this.scrollPages=[{top:0,path:location.href,title:document.title}];this.scrollPageIndex=0;this.scrollHistoryHandler=this.onScrollHistory.bind(this);this.unloadHandler=
this.onUnload.bind(this);this.scroller.addEventListener("scroll",this.scrollHistoryHandler);this.on("append",this.onAppendHistory);this.bindHistoryAppendEvents(!0)},b.bindHistoryAppendEvents=function(a){a=a?"addEventListener":"removeEventListener";this.scroller[a]("scroll",this.scrollHistoryHandler);d[a]("unload",this.unloadHandler)},b.createHistoryPageLoad=function(){this.on("load",this.onPageLoadHistory)},c.destroy.history=b.destroyHistory=function(){this.options.history&&this.options.append&&this.bindHistoryAppendEvents(!1)},
b.onAppendHistory=function(b,c,d){d=this.getElementScrollY(d[0]);a.href=c;this.scrollPages.push({top:d,path:a.href,title:b.title})},b.getElementScrollY=function(a){return this.options.elementScroll?this.getElementElementScrollY(a):this.getElementWindowScrollY(a)},b.getElementWindowScrollY=function(a){return a.getBoundingClientRect().top+d.pageYOffset},b.getElementElementScrollY=function(a){return a.offsetTop-this.top},b.onScrollHistory=function(){for(var a,b,c=this.getScrollViewY(),d=0;d<this.scrollPages.length;d++){var f=
this.scrollPages[d];if(f.top>=c)break;a=d;b=f}a!=this.scrollPageIndex&&(this.scrollPageIndex=a,this.setHistory(b.title,b.path))},f.debounceMethod(c,"onScrollHistory",150),b.getScrollViewY=function(){return this.options.elementScroll?this.scroller.scrollTop+this.scroller.clientHeight/2:d.pageYOffset+this.windowHeight/2},b.setHistory=function(a,b){var c=this.options.history;c&&history[c+"State"]&&(history[c+"State"](null,a,b),this.options.historyTitle&&(document.title=a),this.dispatchEvent("history",
null,[a,b]))},b.onUnload=function(){var a=this.scrollPageIndex;0!==a&&(a=d.pageYOffset-this.scrollPages[a].top+this.top,this.destroyHistory(),scrollTo(0,a))},b.onPageLoadHistory=function(a,b){this.setHistory(a.title,b)},c});
(function(d,c){"function"==typeof define&&define.amd?define("infinite-scroll/js/button",["./core","fizzy-ui-utils/utils"],function(f,b){return c(d,f,b)}):"object"==typeof module&&module.exports?module.exports=c(d,require("./core"),require("fizzy-ui-utils")):c(d,d.InfiniteScroll,d.fizzyUIUtils)})(window,function(d,c,f){function b(a,b){this.element=a;this.infScroll=b;this.clickHandler=this.onClick.bind(this);this.element.addEventListener("click",this.clickHandler);b.on("request",this.disable.bind(this));
b.on("load",this.enable.bind(this));b.on("error",this.hide.bind(this));b.on("last",this.hide.bind(this))}return c.create.button=function(){var a=f.getQueryElement(this.options.button);if(a)return void(this.button=new b(a,this))},c.destroy.button=function(){this.button&&this.button.destroy()},b.prototype.onClick=function(a){a.preventDefault();this.infScroll.loadNextPage()},b.prototype.enable=function(){this.element.removeAttribute("disabled")},b.prototype.disable=function(){this.element.disabled="disabled"},
b.prototype.hide=function(){this.element.style.display="none"},b.prototype.destroy=function(){this.element.removeEventListener("click",this.clickHandler)},c.Button=b,c});
(function(d,c){"function"==typeof define&&define.amd?define("infinite-scroll/js/status",["./core","fizzy-ui-utils/utils"],function(f,b){return c(d,f,b)}):"object"==typeof module&&module.exports?module.exports=c(d,require("./core"),require("fizzy-ui-utils")):c(d,d.InfiniteScroll,d.fizzyUIUtils)})(window,function(d,c,f){d=c.prototype;return c.create.status=function(){var b=f.getQueryElement(this.options.status);b&&(this.statusElement=b,this.statusEventElements={request:b.querySelector(".infinite-scroll-request"),
error:b.querySelector(".infinite-scroll-error"),last:b.querySelector(".infinite-scroll-last")},this.on("request",this.showRequestStatus),this.on("error",this.showErrorStatus),this.on("last",this.showLastStatus),this.bindHideStatus("on"))},d.bindHideStatus=function(b){this[b](this.options.append?"append":"load",this.hideAllStatus)},d.showRequestStatus=function(){this.showStatus("request")},d.showErrorStatus=function(){this.showStatus("error")},d.showLastStatus=function(){this.showStatus("last");this.bindHideStatus("off")},
d.showStatus=function(b){var a=this.statusElement;a&&(a.style.display="block");this.hideStatusEventElements();(b=this.statusEventElements[b])&&(b.style.display="block")},d.hideAllStatus=function(){var b=this.statusElement;b&&(b.style.display="none");this.hideStatusEventElements()},d.hideStatusEventElements=function(){for(var b in this.statusEventElements){var a=this.statusEventElements[b];a&&(a.style.display="none")}},c});
(function(d,c){"function"==typeof define&&define.amd?define("infinite-scroll/js/core infinite-scroll/js/page-load infinite-scroll/js/scroll-watch infinite-scroll/js/history infinite-scroll/js/button infinite-scroll/js/status".split(" "),c):"object"==typeof module&&module.exports&&(module.exports=c(require("./core"),require("./page-load"),require("./scroll-watch"),require("./history"),require("./button"),require("./status")))})(window,function(d){return d});
(function(d,c){"function"==typeof define&&define.amd?define("imagesloaded/imagesloaded",["ev-emitter/ev-emitter"],function(f){return c(d,f)}):"object"==typeof module&&module.exports?module.exports=c(d,require("ev-emitter")):d.imagesLoaded=c(d,d.EvEmitter)})("undefined"!=typeof window?window:this,function(d,c){function f(a,b){for(var c in b)a[c]=b[c];return a}function b(a,c,d){if(!(this instanceof b))return new b(a,c,d);var e=a;"string"==typeof a&&(e=document.querySelectorAll(a));e?(a=e,a=Array.isArray(a)?
a:"object"==typeof a&&"number"==typeof a.length?n.call(a):[a],c=(this.elements=a,this.options=f({},this.options),"function"==typeof c?d=c:f(this.options,c),d&&this.on("always",d),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(this.check.bind(this)))):c=void k.error("Bad element for imagesLoaded "+(e||a));return c}function a(a){this.img=a}function e(a,b){this.url=a;this.element=b;this.img=new Image}var h=d.jQuery,k=d.console,n=Array.prototype.slice;b.prototype=Object.create(c.prototype);
b.prototype.options={};b.prototype.getImages=function(){this.images=[];this.elements.forEach(this.addElementImages,this)};b.prototype.addElementImages=function(a){"IMG"==a.nodeName&&this.addImage(a);!0===this.options.background&&this.addElementBackgroundImages(a);var b=a.nodeType;if(b&&m[b]){for(var c=a.querySelectorAll("img"),b=0;b<c.length;b++)this.addImage(c[b]);if("string"==typeof this.options.background)for(a=a.querySelectorAll(this.options.background),b=0;b<a.length;b++)this.addElementBackgroundImages(a[b])}};
var m={1:!0,9:!0,11:!0};return b.prototype.addElementBackgroundImages=function(a){var b=getComputedStyle(a);if(b)for(var c=/url\((['"])?(.*?)\1\)/gi,d=c.exec(b.backgroundImage);null!==d;)(d=d&&d[2])&&this.addBackground(d,a),d=c.exec(b.backgroundImage)},b.prototype.addImage=function(b){b=new a(b);this.images.push(b)},b.prototype.addBackground=function(a,b){var c=new e(a,b);this.images.push(c)},b.prototype.check=function(){function a(a,c,d){setTimeout(function(){b.progress(a,c,d)})}var b=this;return this.progressedCount=
0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(b){b.once("progress",a);b.check()}):void this.complete()},b.prototype.progress=function(a,b,c){this.progressedCount++;this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;this.emitEvent("progress",[this,a,b]);this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,a);this.progressedCount==this.images.length&&this.complete();this.options.debug&&k&&k.log("progress: "+c,a,b)},b.prototype.complete=function(){var a=this.hasAnyBroken?
"fail":"done";if(this.isComplete=!0,this.emitEvent(a,[this]),this.emitEvent("always",[this]),this.jqDeferred)this.jqDeferred[this.hasAnyBroken?"reject":"resolve"](this)},a.prototype=Object.create(c.prototype),a.prototype.check=function(){return this.getIsImageComplete()?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",
this),void(this.proxyImage.src=this.img.src))},a.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},a.prototype.confirm=function(a,b){this.isLoaded=a;this.emitEvent("progress",[this,this.img,b])},a.prototype.handleEvent=function(a){var b="on"+a.type;this[b]&&this[b](a)},a.prototype.onload=function(){this.confirm(!0,"onload");this.unbindEvents()},a.prototype.onerror=function(){this.confirm(!1,"onerror");this.unbindEvents()},a.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",
this);this.proxyImage.removeEventListener("error",this);this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)},e.prototype=Object.create(a.prototype),e.prototype.check=function(){this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.img.src=this.url;this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},e.prototype.unbindEvents=function(){this.img.removeEventListener("load",this);this.img.removeEventListener("error",
this)},e.prototype.confirm=function(a,b){this.isLoaded=a;this.emitEvent("progress",[this,this.element,b])},b.makeJQueryPlugin=function(a){(a=a||d.jQuery)&&(h=a,h.fn.imagesLoaded=function(a,c){return(new b(this,a,c)).jqDeferred.promise(h(this))})},b.makeJQueryPlugin(),b});
